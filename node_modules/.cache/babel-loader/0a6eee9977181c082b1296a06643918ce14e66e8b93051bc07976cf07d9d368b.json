{"ast":null,"code":"import _regeneratorRuntime from \"D:/NU/COMPUTER SCEINCE/Web/realtime-chat-app-vue3-main/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/NU/COMPUTER SCEINCE/Web/realtime-chat-app-vue3-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\n// import { io } from \"socket.io-client\";\nimport { ref, onMounted, nextTick } from 'vue';\nimport socket from '../socket';\nvar text = ref('');\nvar messages = ref([]);\nvar messageRef = ref(null);\n\n//socket.join('chatroom');\n// socket.on('chatroom',(data)=>{\n//   console.log(\"SUIIIIIIIIIIIIIIIIIIIIIIIII\");\n// })\n// socket.on(\"send-message\", (data) => {\n//     console.log(\"Client Connected !!!! \", data);\n//     messages.value.push(data.message);\n// });\n\nsocket.on(\"private message\", function (_ref) {\n  var message = _ref.message,\n    from = _ref.from;\n  console.log(\"MEEESAAGE \", from);\n  console.log(\"IDDD \", message);\n  messages.value.push({\n    message: message,\n    from: from\n  });\n});\nexport default {\n  props: ['userId', 'friendName'],\n  setup: function setup() {\n    return {\n      text: text,\n      messages: messages,\n      messageRef: messageRef\n    };\n  },\n  mounted: function mounted() {\n    console.log(\"SOSOSOSOSOSOSOS\");\n    console.log(\"SOCKET  \", socket.id);\n    console.log(\"USERID \", socket.auth.userId);\n    // console.log(\"USERTOKEN  ==>  \",this.state.userToken);\n    // console.log(\"RECIEVERID  --> \",this.userId);\n\n    fetch(\"http://localhost:3000/chat/messages\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + this.state.userToken\n      },\n      body: JSON.stringify({\n        recieverId: this.userId\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (response) {\n      console.log(\"RETURNED MESSAGES  ====>  \");\n      console.log(response);\n      messages.value = response.messages;\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  },\n  methods: {\n    sendMessage: function () {\n      var _sendMessage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(message) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              //       const URL = \"http://localhost:3000\";\n              //       const socket = io(URL, { autoConnect: false });\n              //       socket.auth = { userId:this.state.myUserId };\n              //       socket.connect();\n\n              console.log(\"ffffffffffffffffffffffffffffffffffffffffffffffffffffff\", this.state.myUserId);\n              console.log(socket.id);\n              socket.emit(\"private message\", {\n                message: message,\n                to: this.userId,\n                from: this.state.myUserId\n              });\n\n              // fetch(\"http://localhost:3000/chat/send\",{\n              //   method:\"POST\",\n              //   headers:{\n              //     \"Content-Type\":\"application/json\",\n              //     Authorization:\"Bearer \" + this.state.userToken\n              //   },\n              //   body:JSON.stringify({\n              //     message:message2,\n              //     recieverId:this.userId\n              //   })\n              // }).then(res=>{\n              //   return res.json()\n              // }).then(response=>{\n              //     console.log(\"SENT MESSAGE ___ \")\n              //     console.log(response)\n              // }).catch(err=>{\n              //   console.log(err);\n              // });\n\n              messages.value.push({\n                message: message,\n                from: this.state.myUserId\n              });\n              _context.next = 6;\n              return nextTick();\n            case 6:\n              messageRef.value.scrollTop = messageRef.value.scrollHeight;\n              text.value = '';\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function sendMessage(_x) {\n        return _sendMessage.apply(this, arguments);\n      }\n      return sendMessage;\n    }()\n  }\n};\n\n// TO DO  meesageRef.value.scrollTop = messageRef.value.scrollHeight","map":{"version":3,"names":["ref","onMounted","nextTick","socket","text","messages","messageRef","on","_ref","message","from","console","log","value","push","props","setup","mounted","id","auth","userId","fetch","method","headers","state","userToken","body","JSON","stringify","recieverId","then","res","json","response","err","methods","sendMessage","_sendMessage","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","myUserId","emit","to","scrollTop","scrollHeight","stop","_x","apply","arguments"],"sources":["D:\\NU\\COMPUTER SCEINCE\\Web\\realtime-chat-app-vue3-main\\src\\views\\ChatView.vue"],"sourcesContent":["<template>\n<div class=\"panel\">\n   <h3> {{ $route.params.friendName }} </h3> \n    <div class=\"messages\" ref=\"messageRef\">\n         <div class=\"inner\">\n           <div v-for=\"(message,index) in messages\" :key=\"index\" class=\"message\">\n              <div v-if=\"message.from === userId\" class=\"user-self\">\n                {{$route.params.friendName}}:\n              </div>\n              <div v-else class=\"user-them\"> \n                You: \n                 \n              </div>\n                \t{{message.message}}   {{ userId }}   ===  {{ message.from }}\n           </div>\n         </div>          \n    </div>\n<form>\n           <input v-model=\"text\">\n           <button @click.prevent=\"sendMessage(text)\">+</button>\n         </form>  \n  </div>\t\n</template>\n<script>\n// import { io } from \"socket.io-client\";\nimport {ref,onMounted,nextTick} from 'vue';\nimport socket from '../socket';\nconst text = ref('');\nconst messages = ref([]);\nconst messageRef = ref(null);\n\n    \n//socket.join('chatroom');\n// socket.on('chatroom',(data)=>{\n//   console.log(\"SUIIIIIIIIIIIIIIIIIIIIIIIII\");\n// })\n// socket.on(\"send-message\", (data) => {\n//     console.log(\"Client Connected !!!! \", data);\n//     messages.value.push(data.message);\n// });\n\nsocket.on(\"private message\", ({ message, from }) => {\n  console.log(\"MEEESAAGE \",from);\n  console.log(\"IDDD \",message);\n      messages.value.push({message:message,from:from});\n});\nexport default {\n\tprops:['userId','friendName'],\n\t\n\tsetup(){\n\t\treturn {text,messages,messageRef}\n\t},\n  mounted(){\n    console.log(\"SOSOSOSOSOSOSOS\");\n    console.log(\"SOCKET  \",socket.id);\n    console.log(\"USERID \",socket.auth.userId);\n    // console.log(\"USERTOKEN  ==>  \",this.state.userToken);\n    // console.log(\"RECIEVERID  --> \",this.userId);\n\n    fetch(\"http://localhost:3000/chat/messages\",{\n        method:\"POST\",\n        headers:{\n          \"Content-Type\":\"application/json\",\n          \"Authorization\":\"Bearer \" + this.state.userToken\n        },\n        body:JSON.stringify({\n          recieverId:this.userId\n        })\n      }).then(res=>{\n        return res.json()\n      }).then(response=>{\n          console.log(\"RETURNED MESSAGES  ====>  \")\n          console.log(response)\n          messages.value = response.messages\n      }).catch(err=>{\n        console.log(err);\n      });\n\n  },\n\tmethods:{\t\n\t\tsendMessage:async function(message){\n//       const URL = \"http://localhost:3000\";\n//       const socket = io(URL, { autoConnect: false });\n//       socket.auth = { userId:this.state.myUserId };\n//       socket.connect();\n      \n      console.log(\"ffffffffffffffffffffffffffffffffffffffffffffffffffffff\",this.state.myUserId);\n\t\t\tconsole.log(socket.id);\n      socket.emit(\"private message\", {\n        message,\n      to: this.userId,\n      from:this.state.myUserId\n    });\n\n\n\n\n\n\n      // fetch(\"http://localhost:3000/chat/send\",{\n      //   method:\"POST\",\n      //   headers:{\n      //     \"Content-Type\":\"application/json\",\n      //     Authorization:\"Bearer \" + this.state.userToken\n      //   },\n      //   body:JSON.stringify({\n      //     message:message2,\n      //     recieverId:this.userId\n      //   })\n      // }).then(res=>{\n      //   return res.json()\n      // }).then(response=>{\n      //     console.log(\"SENT MESSAGE ___ \")\n      //     console.log(response)\n      // }).catch(err=>{\n      //   console.log(err);\n      // });\n      \n\t\t\tmessages.value.push({message:message,from:this.state.myUserId});\n\t\t\tawait nextTick();\n\t\t\tmessageRef.value.scrollTop = messageRef.value.scrollHeight;\n\t\t\ttext.value = ''\n\t\t}\n\t}\n}\n\n\n// TO DO  meesageRef.value.scrollTop = messageRef.value.scrollHeight\n\n</script>\n\n<style>\n\t.panel{\n  display: flex;\n  flex-direction: column;\n  padding: 20px;\n  margin: 0 auto;\n  max-width: 300px;\n  height: 300px;\n  background: rgba(255,255,255,0.7);\n  box-shadow: 0 8px 32px 0 rgba(31,38,135,0.37);\n  border-radius: 10px;\n  border: 1px solid rgba(188,255,255,0.18);\n}\n.messages{\n  height: 100%;\n  width: 100%;\n  overflow-y: scroll;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  background-color: white;\n}\n.inner{\n  padding: 10px;\n}\n\n.message{\n  text-align: left;\n  display: flex;\n  margin-bottom: 6px;\n}\n.user-self{\n  color: green;\n}\n.user-them{\n  color:red;\n}\nform{\n  position: relative;\n  display: flex;\n}\ninput{\n  width: 100%;\n  border:none;\n  height: 20px;\n  padding: 8px;\n  border-top: 1px solid #999;\n  border-radius: 0px;\n  outline: none;\n}\nbutton{\n  border:none;\n  outline:none;\n  background:none;\n  position: absolute;\n  right: 3px;\n  top: 4px;\n  font-size: 24px;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}