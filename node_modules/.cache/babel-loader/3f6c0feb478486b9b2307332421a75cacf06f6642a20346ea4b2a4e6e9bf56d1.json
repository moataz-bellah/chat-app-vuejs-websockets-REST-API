{"ast":null,"code":"import _regeneratorRuntime from \"D:/NU/realtime-chat-app-vue3-main/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/NU/realtime-chat-app-vue3-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport { io } from \"socket.io-client\";\nimport { ref, onMounted, nextTick } from 'vue';\nvar text = ref('');\nvar messages = ref([]);\nvar messageRef = ref(null);\nvar socket = io(\"http://localhost:3000\");\nsocket.on(\"send-message\", function (data) {\n  console.log(\"Client Connected !!!! \", data);\n  messages.value.push(data.message);\n});\nexport default {\n  props: ['userId', 'friendName'],\n  setup: function setup() {\n    return {\n      text: text,\n      messages: messages,\n      messageRef: messageRef\n    };\n  },\n  mounted: function mounted() {\n    console.log(\"USERTOKEN  ==>  \", this.state.userToken);\n    console.log(\"RECIEVERID  --> \", this.userId);\n    fetch(\"http://localhost:3000/chat/messages\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"Bearer \" + this.state.userToken\n      },\n      body: JSON.stringify({\n        recieverId: this.userId\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (response) {\n      console.log(\"RETURNED MESSAGES  ====>  \");\n      console.log(response);\n      messages.value = response.messages;\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n  },\n  updated: function updated() {},\n  methods: {\n    sendMessage: function () {\n      var _sendMessage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(message2) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"SUIIIIIIIIIIIIIIIIIIIIIIII\");\n              console.log(this.state.userToken);\n              fetch(\"http://localhost:3000/chat/send\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  Authorization: \"Bearer \" + this.state.userToken\n                },\n                body: JSON.stringify({\n                  message: message2,\n                  recieverId: this.userId\n                })\n              }).then(function (res) {\n                return res.json();\n              }).then(function (response) {\n                console.log(\"SENT MESSAGE ___ \");\n                console.log(response);\n              })[\"catch\"](function (err) {\n                console.log(err);\n              });\n              messages.value.push(message2);\n              _context.next = 6;\n              return nextTick();\n            case 6:\n              messageRef.value.scrollTop = messageRef.value.scrollHeight;\n              text.value = '';\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function sendMessage(_x) {\n        return _sendMessage.apply(this, arguments);\n      }\n      return sendMessage;\n    }()\n  }\n};\n\n// TO DO  meesageRef.value.scrollTop = messageRef.value.scrollHeight","map":{"version":3,"names":["io","ref","onMounted","nextTick","text","messages","messageRef","socket","on","data","console","log","value","push","message","props","setup","mounted","state","userToken","userId","fetch","method","headers","body","JSON","stringify","recieverId","then","res","json","response","err","updated","methods","sendMessage","_sendMessage","_asyncToGenerator","_regeneratorRuntime","mark","_callee","message2","wrap","_callee$","_context","prev","next","Authorization","scrollTop","scrollHeight","stop","_x","apply","arguments"],"sources":["D:\\NU\\realtime-chat-app-vue3-main\\src\\views\\ChatView.vue"],"sourcesContent":["<template>\n<div class=\"panel\">\n    {{ friendName }} {{ userId }}\n    <div class=\"messages\" ref=\"messageRef\">\n         <div class=\"inner\">\n           <div v-for=\"(message,index) in messages\" :key=\"index\" class=\"message\">\n              <div v-if=\"message.reciever === userId\" class=\"user-self\">\n                    You: \n              </div>\n              <div v-if=\"message.reciever !== userId\" class=\"user-them\"> \n                Him:\n              </div>\n                \t{{message.text}}  \n           </div>\n         </div>          \n    </div>\n<form>\n           <input v-model=\"text\">\n           <button @click.prevent=\"sendMessage(text)\">+</button>\n         </form>  \n  </div>\t\n</template>\n<script>\nimport { io } from \"socket.io-client\";\nimport {ref,onMounted,nextTick} from 'vue';\nconst text = ref('');\nconst messages = ref([]);\nconst messageRef = ref(null);\nconst socket = io(\"http://localhost:3000\");\nsocket.on(\"send-message\", (data) => {\n    console.log(\"Client Connected !!!! \", data);\n    messages.value.push(data.message);\n});\nexport default {\n\tprops:['userId','friendName'],\n\t\n\tsetup(){\n\t\treturn {text,messages,messageRef}\n\t},\n  mounted(){\n    console.log(\"USERTOKEN  ==>  \",this.state.userToken);\n    console.log(\"RECIEVERID  --> \",this.userId);\n\n    fetch(\"http://localhost:3000/chat/messages\",{\n        method:\"POST\",\n        headers:{\n          \"Content-Type\":\"application/json\",\n          \"Authorization\":\"Bearer \" + this.state.userToken\n        },\n        body:JSON.stringify({\n          recieverId:this.userId\n        })\n      }).then(res=>{\n        return res.json()\n      }).then(response=>{\n          console.log(\"RETURNED MESSAGES  ====>  \")\n          console.log(response)\n          messages.value = response.messages\n      }).catch(err=>{\n        console.log(err);\n      });\n\n  },\n  updated(){\n   \n  },\n\tmethods:{\t\n\t\tsendMessage:async function(message2){\n      console.log(\"SUIIIIIIIIIIIIIIIIIIIIIIII\");\n\t\t\tconsole.log(this.state.userToken)\n      fetch(\"http://localhost:3000/chat/send\",{\n        method:\"POST\",\n        headers:{\n          \"Content-Type\":\"application/json\",\n          Authorization:\"Bearer \" + this.state.userToken\n        },\n        body:JSON.stringify({\n          message:message2,\n          recieverId:this.userId\n        })\n      }).then(res=>{\n        return res.json()\n      }).then(response=>{\n          console.log(\"SENT MESSAGE ___ \")\n          console.log(response)\n      }).catch(err=>{\n        console.log(err);\n      });\n      \n\t\t\tmessages.value.push(message2);\n\t\t\tawait nextTick();\n\t\t\tmessageRef.value.scrollTop = messageRef.value.scrollHeight;\n\t\t\ttext.value = ''\n\t\t}\n\t}\n}\n\n\n// TO DO  meesageRef.value.scrollTop = messageRef.value.scrollHeight\n\n</script>\n\n<style>\n\t.panel{\n  display: flex;\n  flex-direction: column;\n  padding: 20px;\n  margin: 0 auto;\n  max-width: 300px;\n  height: 300px;\n  background: rgba(255,255,255,0.7);\n  box-shadow: 0 8px 32px 0 rgba(31,38,135,0.37);\n  border-radius: 10px;\n  border: 1px solid rgba(188,255,255,0.18);\n}\n.messages{\n  height: 100%;\n  width: 100%;\n  overflow-y: scroll;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  background-color: white;\n}\n.inner{\n  padding: 10px;\n}\n\n.message{\n  text-align: left;\n  display: flex;\n  margin-bottom: 6px;\n}\n.user-self{\n  color: green;\n}\n.user-them{\n  color:red;\n}\nform{\n  position: relative;\n  display: flex;\n}\ninput{\n  width: 100%;\n  border:none;\n  height: 20px;\n  padding: 8px;\n  border-top: 1px solid #999;\n  border-radius: 0px;\n  outline: none;\n}\nbutton{\n  border:none;\n  outline:none;\n  background:none;\n  position: absolute;\n  right: 3px;\n  top: 4px;\n  font-size: 24px;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}