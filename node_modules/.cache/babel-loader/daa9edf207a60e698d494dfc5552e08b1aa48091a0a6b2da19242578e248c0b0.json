{"ast":null,"code":"import _regeneratorRuntime from \"D:/NU/COMPUTER SCEINCE/Web/realtime-chat-app-vue3-main/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/NU/COMPUTER SCEINCE/Web/realtime-chat-app-vue3-main/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport { io } from \"socket.io-client\";\nimport { ref, onMounted, nextTick } from 'vue';\nvar text = ref('');\nvar messages = ref([]);\nvar messageRef = ref(null);\nvar socket = io(\"http://localhost:3000\");\n//socket.join('chatroom');\n// socket.on('chatroom',(data)=>{\n//   console.log(\"SUIIIIIIIIIIIIIIIIIIIIIIIII\");\n// })\n// socket.on(\"send-message\", (data) => {\n//     console.log(\"Client Connected !!!! \", data);\n//     messages.value.push(data.message);\n// });\n\nsocket.id = this;\nsocket.on(\"private message\", function (_ref) {\n  var message = _ref.message,\n    from = _ref.from;\n  console.log(\"MEEESAAGE \");\n  if (from === socket.id) {\n    console.log(\"MEEESAAGE \", message);\n    messages.value.push(message);\n  }\n});\nexport default {\n  props: ['userId', 'friendName'],\n  setup: function setup() {\n    return {\n      text: text,\n      messages: messages,\n      messageRef: messageRef\n    };\n  },\n  mounted: function mounted() {\n    // console.log(\"USERTOKEN  ==>  \",this.state.userToken);\n    // console.log(\"RECIEVERID  --> \",this.userId);\n\n    // fetch(\"http://localhost:3000/chat/messages\",{\n    //     method:\"POST\",\n    //     headers:{\n    //       \"Content-Type\":\"application/json\",\n    //       \"Authorization\":\"Bearer \" + this.state.userToken\n    //     },\n    //     body:JSON.stringify({\n    //       recieverId:this.userId\n    //     })\n    //   }).then(res=>{\n    //     return res.json()\n    //   }).then(response=>{\n    //       console.log(\"RETURNED MESSAGES  ====>  \")\n    //       console.log(response)\n    //       messages.value = response.messages\n    //   }).catch(err=>{\n    //     console.log(err);\n    //   });\n  },\n  methods: {\n    sendMessage: function () {\n      var _sendMessage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(message) {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              console.log(\"ffffffffffffffffffffffffffffffffffffffffffffffffffffff\");\n              console.log(socket.id);\n              socket.emit(\"private message\", {\n                message: message,\n                to: this.userId,\n                from: socket.id\n              });\n              // fetch(\"http://localhost:3000/chat/send\",{\n              //   method:\"POST\",\n              //   headers:{\n              //     \"Content-Type\":\"application/json\",\n              //     Authorization:\"Bearer \" + this.state.userToken\n              //   },\n              //   body:JSON.stringify({\n              //     message:message2,\n              //     recieverId:this.userId\n              //   })\n              // }).then(res=>{\n              //   return res.json()\n              // }).then(response=>{\n              //     console.log(\"SENT MESSAGE ___ \")\n              //     console.log(response)\n              // }).catch(err=>{\n              //   console.log(err);\n              // });\n\n              messages.value.push(message);\n              _context.next = 6;\n              return nextTick();\n            case 6:\n              messageRef.value.scrollTop = messageRef.value.scrollHeight;\n              text.value = '';\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function sendMessage(_x) {\n        return _sendMessage.apply(this, arguments);\n      }\n      return sendMessage;\n    }()\n  }\n};\n\n// TO DO  meesageRef.value.scrollTop = messageRef.value.scrollHeight","map":{"version":3,"names":["io","ref","onMounted","nextTick","text","messages","messageRef","socket","id","on","_ref","message","from","console","log","value","push","props","setup","mounted","methods","sendMessage","_sendMessage","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","emit","to","userId","scrollTop","scrollHeight","stop","_x","apply","arguments"],"sources":["D:\\NU\\COMPUTER SCEINCE\\Web\\realtime-chat-app-vue3-main\\src\\views\\ChatView.vue"],"sourcesContent":["<template>\n<div class=\"panel\">\n   <h3> {{ $route.params.friendName }} </h3> \n    <div class=\"messages\" ref=\"messageRef\">\n         <div class=\"inner\">\n           <div v-for=\"(message,index) in messages\" :key=\"index\" class=\"message\">\n              <div v-if=\"message.reciever === userId\" class=\"user-self\">\n                    You: \n              </div>\n              <div v-else class=\"user-them\"> \n                {{$route.params.friendName}}:\n              </div>\n                \t{{message}} \n           </div>\n         </div>          \n    </div>\n<form>\n           <input v-model=\"text\">\n           <button @click.prevent=\"sendMessage(text)\">+</button>\n         </form>  \n  </div>\t\n</template>\n<script>\nimport { io } from \"socket.io-client\";\nimport {ref,onMounted,nextTick} from 'vue';\nconst text = ref('');\nconst messages = ref([]);\nconst messageRef = ref(null);\nconst socket = io(\"http://localhost:3000\");\n//socket.join('chatroom');\n// socket.on('chatroom',(data)=>{\n//   console.log(\"SUIIIIIIIIIIIIIIIIIIIIIIIII\");\n// })\n// socket.on(\"send-message\", (data) => {\n//     console.log(\"Client Connected !!!! \", data);\n//     messages.value.push(data.message);\n// });\n\nsocket.id = this\nsocket.on(\"private message\", ({ message, from }) => {\n  console.log(\"MEEESAAGE \")\n    if(from === socket.id){\n      console.log(\"MEEESAAGE \",message)\n      messages.value.push(message);\n\n    }\n});\nexport default {\n\tprops:['userId','friendName'],\n\t\n\tsetup(){\n\t\treturn {text,messages,messageRef}\n\t},\n  mounted(){\n    // console.log(\"USERTOKEN  ==>  \",this.state.userToken);\n    // console.log(\"RECIEVERID  --> \",this.userId);\n\n    // fetch(\"http://localhost:3000/chat/messages\",{\n    //     method:\"POST\",\n    //     headers:{\n    //       \"Content-Type\":\"application/json\",\n    //       \"Authorization\":\"Bearer \" + this.state.userToken\n    //     },\n    //     body:JSON.stringify({\n    //       recieverId:this.userId\n    //     })\n    //   }).then(res=>{\n    //     return res.json()\n    //   }).then(response=>{\n    //       console.log(\"RETURNED MESSAGES  ====>  \")\n    //       console.log(response)\n    //       messages.value = response.messages\n    //   }).catch(err=>{\n    //     console.log(err);\n    //   });\n\n  },\n\tmethods:{\t\n\t\tsendMessage:async function(message){\n      console.log(\"ffffffffffffffffffffffffffffffffffffffffffffffffffffff\");\n\t\t\tconsole.log(socket.id);\n      socket.emit(\"private message\", {\n        message,\n      to: this.userId,\n      from:socket.id\n    });\n      // fetch(\"http://localhost:3000/chat/send\",{\n      //   method:\"POST\",\n      //   headers:{\n      //     \"Content-Type\":\"application/json\",\n      //     Authorization:\"Bearer \" + this.state.userToken\n      //   },\n      //   body:JSON.stringify({\n      //     message:message2,\n      //     recieverId:this.userId\n      //   })\n      // }).then(res=>{\n      //   return res.json()\n      // }).then(response=>{\n      //     console.log(\"SENT MESSAGE ___ \")\n      //     console.log(response)\n      // }).catch(err=>{\n      //   console.log(err);\n      // });\n      \n\t\t\tmessages.value.push(message);\n\t\t\tawait nextTick();\n\t\t\tmessageRef.value.scrollTop = messageRef.value.scrollHeight;\n\t\t\ttext.value = ''\n\t\t}\n\t}\n}\n\n\n// TO DO  meesageRef.value.scrollTop = messageRef.value.scrollHeight\n\n</script>\n\n<style>\n\t.panel{\n  display: flex;\n  flex-direction: column;\n  padding: 20px;\n  margin: 0 auto;\n  max-width: 300px;\n  height: 300px;\n  background: rgba(255,255,255,0.7);\n  box-shadow: 0 8px 32px 0 rgba(31,38,135,0.37);\n  border-radius: 10px;\n  border: 1px solid rgba(188,255,255,0.18);\n}\n.messages{\n  height: 100%;\n  width: 100%;\n  overflow-y: scroll;\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n  background-color: white;\n}\n.inner{\n  padding: 10px;\n}\n\n.message{\n  text-align: left;\n  display: flex;\n  margin-bottom: 6px;\n}\n.user-self{\n  color: green;\n}\n.user-them{\n  color:red;\n}\nform{\n  position: relative;\n  display: flex;\n}\ninput{\n  width: 100%;\n  border:none;\n  height: 20px;\n  padding: 8px;\n  border-top: 1px solid #999;\n  border-radius: 0px;\n  outline: none;\n}\nbutton{\n  border:none;\n  outline:none;\n  background:none;\n  position: absolute;\n  right: 3px;\n  top: 4px;\n  font-size: 24px;\n}\n</style>"],"mappings":";;;AAuBA,SAASA,EAAC,QAAS,kBAAkB;AACrC,SAAQC,GAAG,EAACC,SAAS,EAACC,QAAQ,QAAO,KAAK;AAC1C,IAAMC,IAAG,GAAIH,GAAG,CAAC,EAAE,CAAC;AACpB,IAAMI,QAAO,GAAIJ,GAAG,CAAC,EAAE,CAAC;AACxB,IAAMK,UAAS,GAAIL,GAAG,CAAC,IAAI,CAAC;AAC5B,IAAMM,MAAK,GAAIP,EAAE,CAAC,uBAAuB,CAAC;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAO,MAAM,CAACC,EAAC,GAAI,IAAG;AACfD,MAAM,CAACE,EAAE,CAAC,iBAAiB,EAAE,UAAAC,IAAA,EAAuB;EAAA,IAApBC,OAAO,GAAAD,IAAA,CAAPC,OAAO;IAAEC,IAAG,GAAAF,IAAA,CAAHE,IAAG;EAC1CC,OAAO,CAACC,GAAG,CAAC,YAAY;EACtB,IAAGF,IAAG,KAAML,MAAM,CAACC,EAAE,EAAC;IACpBK,OAAO,CAACC,GAAG,CAAC,YAAY,EAACH,OAAO;IAChCN,QAAQ,CAACU,KAAK,CAACC,IAAI,CAACL,OAAO,CAAC;EAE9B;AACJ,CAAC,CAAC;AACF,eAAe;EACdM,KAAK,EAAC,CAAC,QAAQ,EAAC,YAAY,CAAC;EAE7BC,KAAK,WAAAA,MAAA,EAAE;IACN,OAAO;MAACd,IAAI,EAAJA,IAAI;MAACC,QAAQ,EAARA,QAAQ;MAACC,UAAU,EAAVA;IAAU;EACjC,CAAC;EACAa,OAAO,WAAAA,QAAA,EAAE;IACP;IACA;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EAAA,CAED;EACFC,OAAO,EAAC;IACPC,WAAW;MAAA,IAAAC,YAAA,GAAAC,iBAAA,eAAAC,mBAAA,GAAAC,IAAA,CAAC,SAAAC,QAAef,OAAO;QAAA,OAAAa,mBAAA,GAAAG,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAC9BlB,OAAO,CAACC,GAAG,CAAC,wDAAwD,CAAC;cACxED,OAAO,CAACC,GAAG,CAACP,MAAM,CAACC,EAAE,CAAC;cACnBD,MAAM,CAACyB,IAAI,CAAC,iBAAiB,EAAE;gBAC7BrB,OAAO,EAAPA,OAAO;gBACTsB,EAAE,EAAE,IAAI,CAACC,MAAM;gBACftB,IAAI,EAACL,MAAM,CAACC;cACd,CAAC,CAAC;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;cACA;;cAEHH,QAAQ,CAACU,KAAK,CAACC,IAAI,CAACL,OAAO,CAAC;cAAAkB,QAAA,CAAAE,IAAA;cAAA,OACtB5B,QAAQ,CAAC,CAAC;YAAA;cAChBG,UAAU,CAACS,KAAK,CAACoB,SAAQ,GAAI7B,UAAU,CAACS,KAAK,CAACqB,YAAY;cAC1DhC,IAAI,CAACW,KAAI,GAAI,EAAC;YAAA;YAAA;cAAA,OAAAc,QAAA,CAAAQ,IAAA;UAAA;QAAA,GAAAX,OAAA;MAAA,CACf;MAAA,SAAAL,YAAAiB,EAAA;QAAA,OAAAhB,YAAA,CAAAiB,KAAA,OAAAC,SAAA;MAAA;MAAA,OAAAnB,WAAA;IAAA;EACD;AACD;;AAGA"},"metadata":{},"sourceType":"module","externalDependencies":[]}